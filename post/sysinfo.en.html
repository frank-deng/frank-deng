<!DOCTYPE html>
<html>
	<head>
		<meta name='viewport' id='viewport' content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no'/>
		<meta charset='UTF-8'/>
		<title>Fetch System Information Using Python3 - Frank's Space</title>
		<link rel='stylesheet' type='text/css' href='/css/common.css'/>
		<link rel='stylesheet' type='text/css' href='/css/document.css'/>
	</head>
	<body>
		<div class='header-wrapper'>
			<div class='header'>
				
<a class='site-title' href='/'>Frank's Space</a>


			</div>
		</div>
		<div class='main-content'>
			<h1 id="fetch-system-information-using-python3">Fetch System Information Using Python3</h1>

<h2 id="get-cpu-temperature">Get CPU Temperature</h2>

<p>Read numeric value from file <code class="highlighter-rouge">/sys/class/thermal/thermal_zone0/temp</code>, then divide the number read by 1000, and you’ll get the CPU Temperature in Celsius degree.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Linux</li>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>with open('/sys/class/thermal/thermal_zone0/temp', 'r') as fp:
    result_c = fp.readline();
cpu_temp = int(float(result_c) / 1000.0); #Get CPU temperature
</code></pre>
</div>

<h2 id="get-nvidia-gpu-temperature">Get Nvidia GPU Temperature</h2>

<p>Run command <code class="highlighter-rouge">nvidia-smi -q -x</code>, then parse the stdout as XML, and you’ll get the GPU Temperature in Celsius degree.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Windows (Require official Nvidia driver)</li>
  <li>Linux (Require official Nvidia driver)</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import subprocess;
import xml.etree.ElementTree as ET;
nvidia_smi = subprocess.Popen(['nvidia-smi', '-q', '-x'], stdout=subprocess.PIPE);
tree = ET.fromstring(nvidia_smi.communicate()[0]);
result_c = tree.findall('./gpu/temperature/gpu_temp')[0].text;
gpu_temp = int(result_c.replace(' C', '')); #Get GPU temperature
</code></pre>
</div>

<h2 id="get-battery-level-of-an-android-phone">Get Battery Level of an Android Phone</h2>

<p>Get battery level using SL4A’s <a href="http://www.mithril.com.au/android/doc/BatteryManagerFacade.html">BatteryManagerFacade</a> API.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import android;
droid = android.Android();
droid.batteryStartMonitoring();
battery_level = droid.batteryGetLevel()[1]; #Get battery level
droid.batteryStopMonitoring();
</code></pre>
</div>

<h2 id="get-overall-cpu-usage">Get Overall CPU Usage</h2>

<p>Get overall CPU usage by analyzing file <code class="highlighter-rouge">/proc/stat</code>.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Linux</li>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import time;
def cpu_usage(sample_interval):
    with open('/proc/stat', 'r') as fp:
        info0 = fp.readline();
    time.sleep(sample_interval);
    with open('/proc/stat', 'r') as fp:
        info1 = fp.readline();
    info0 = [int(n) for n in info0.split()[1:]];
    info1 = [int(n) for n in info1.split()[1:]];
    return float(sum(info1[0:3]) - sum(info0[0:3])) / float(sum(info1) - sum(info0));

# Call function cpu_usage()
print(cpu_usage(0.1));
</code></pre>
</div>

<h2 id="get-cpu-usage-for-each-cpu">Get CPU Usage for Each CPU</h2>

<p>Get CPU usage for each CPU by analyzing file <code class="highlighter-rouge">/proc/stat</code>.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Linux</li>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import time, re;
__re_cpu = re.compile(r'cpu\d+');
def cpu_usage_each(sample_interval):
    with open('/proc/stat', 'r') as fp:
        lines0 = fp.readlines();
    time.sleep(sample_interval);
    with open('/proc/stat', 'r') as fp:
        lines1 = fp.readlines();
    lines0 = [l.split() for l in lines0];
    lines1 = [l.split() for l in lines1];
    info0, info1, result = [], [], [];
    for l in lines0:
        if None != __re_cpu.match(l[0]):
            info0.append([int(n) for n in l[1:]]);
    for l in lines1:
        if None != __re_cpu.match(l[0]):
            info1.append([int(n) for n in l[1:]]);
    for i in range(len(info0)):
        total = sum(info1[i]) - sum(info0[i]);
        if 0 == total:
            result.append(0.0);
        else:
            result.append(float(sum(info1[i][0:3]) - sum(info0[i][0:3])) / float(total));
    return result;

# Call function cpu_usage_each()
print(cpu_usage_each(0.1));
</code></pre>
</div>

<h2 id="get-memory-usage">Get Memory Usage</h2>

<p>Get memory usage by analyzing file <code class="highlighter-rouge">/proc/meminfo</code>.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Linux</li>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import re;
__re_mem_total = re.compile(r'MemTotal:\s*(\d+)');
__re_mem_avail = re.compile(r'MemAvailable:\s*(\d+)');
def mem_usage():
    with open('/proc/meminfo', 'r') as fp:
        meminfo = fp.readlines();
    total = avail = None;
    for line in meminfo:
        m_total = __re_mem_total.match(line);
        m_avail = __re_mem_avail.match(line);
        if None != m_total:
            total = int(m_total.groups()[0]);
        elif None != m_avail:
            avail = int(m_avail.groups()[0]);
    return float(total-avail)/float(total);

# Call function mem_usage()
print(mem_usage());
</code></pre>
</div>

<h2 id="get-boot-time">Get Boot Time</h2>

<p>Get seconds from boot time to now by analyzing file <code class="highlighter-rouge">/proc/uptime</code>.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Linux</li>
  <li>Android + QPython3</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>from datetime import datetime, timedelta;
def boot_time():
    with open('/proc/uptime', 'r') as fp:
        uptime = fp.readline();
    uptime = float(uptime.split()[0]);
    return (datetime.now() - timedelta(0, uptime));

# Call function boot_time()
print(boot_time().strftime('%Y-%m-%dT%H:%M:%S'));
</code></pre>
</div>

<h2 id="get-overall-cpu-usage-memory-usage-boot-time-via-psutil">Get Overall CPU Usage, Memory Usage, Boot Time via <code class="highlighter-rouge">psutil</code></h2>

<p>Get CPU usage in percentage, memory usage in percentage, boot time using <a href="http://pythonhosted.org/psutil/">psutil</a>.</p>

<p><a href="https://pypi.python.org/pypi/psutil">psutil</a> should be installed manually before using the example code here.</p>

<p>Supported Platforms:</p>

<ul>
  <li>Windows</li>
  <li>Linux</li>
</ul>

<p>Example Code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import psutil;
from datetime import datetime;

# Get overall cpu usage
cpu_usage = psutil.cpu_percent(0.1);

# Get memory usage
meminfo = psutil.virtual_memory();
mem_usage = (meminfo.total - meminfo.available) / meminfo.total * 100;

# Get boot time
boot_time = datetime.fromtimestamp(psutil.boot_time()).strftime('%Y-%m-%dT%H:%M:%S');
</code></pre>
</div>

		</div>
	</body>
</html>

